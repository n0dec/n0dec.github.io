function raw_to_rule() {
	var set = {}

	set['name'] = "Rule set name";
	set['version'] = "0.1";
	set['author'] = "autogenerated";
	set['description'] = "Description for rule set.";

	set.rules = {};
	var raw = document.getElementById("raw").value;

	var raw_split = raw.split('\n\n');

	for(var n = 0; n < raw_split.length; n++){
		raw_split2 = raw_split[n].split('\n');
		iter = n + 1
		set.rules['rule' + iter] = {}
		set.rules['rule' + iter].enabled = true;
		set.rules['rule' + iter].source = "Sysmon";
		set.rules['rule' + iter].category = raw_split2[0].slice(0, -1);
		set.rules['rule' + iter].description = 'Description for rule' + iter;
		set.rules['rule' + iter].payload = {}

		for (var i = 1; i < raw_split2.length; i++) {
			var f_split = raw_split2[i].split(': ')
			set.rules['rule' + iter].payload[f_split[0]] = f_split[1]
		}
	}
	var json = JSON.stringify(set, null, "\t");

	document.getElementById("rule").innerHTML = json;
}
